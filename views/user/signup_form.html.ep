<!DOCTYPE html>
<html>
    <head>
        %= stylesheet begin
            label.field-with-error { color: #dd7e5e }
            input.field-with-error { background-color: #fd9e7e }
        % end
    </head>
    <body>
        Stash:<br /><pre><%= dumper stash %></pre><br />
        Validation:<br /><pre><%= dumper validation %></pre><br />
        <h1>Sign Up!</h1>
        % if (my $err = validation->error('username')) {
        <div>
            %= "'Username' is required." if $err->[0] eq 'required';
            %= "'Username' must be between 3 and 45 characters in length." if $err->[0] eq 'size';
        </div>
        % }
        % if (my $err = validation->error('email_address')) {
        <div>
            %= "'Email Address' is required." if $err->[0] eq 'required';
            %= "'Email Address' must be between 8 and 45 characters in length." if $err->[0] eq 'size';
        </div>
        % }
        % if (my $err = validation->error('password')) {
        <div>
            %= "'Password' is required." if $err->[0] eq 'required';
            %= "'Password' must be between 8 and 45 characters in length." if $err->[0] eq 'size';
            %= "'Password' must contain at least one letter, one number, and one of the following symbols (\@\!\#\$\%\^\&\*\.\-\_\+)." if $err->[0] eq 'like';
        </div>
        % }
        % if (my $err = validation->error('password_confirm')) {
        <div>
            %= "'Password Confirmation' is required." if $err->[0] eq 'required';
            %= "'Password Confirmation' must be between 8 and 45 characters in length." if $err->[0] eq 'size';
            %= "'Password Confirmation' must be the same as 'Password'." if $err->[0] eq 'equal_to';
        </div>
        % }
        %# if ( scalar( @form_errors ) > 0 )
        %# {
            <div>
            %# foreach my $error ( @form_errors )
            %# {
                %#= $error . '<br />';
            %# }
            </div>
        %# }
        %= form_for signup_form => begin
            %= label_for username => 'Username (required): ' 
            %= text_field 'username', size => 30, max_length => 45
            <br />
            %= label_for email_address => 'E-mail Address (required): '
            %= email_field 'email_address', size => 30, max_length => 45
            <br />
            %= label_for password => 'Password (required): '
            %= password_field 'password', size => 30
            <br />
            %= label_for password_confirmation => 'Password Confirmation: '
            %= password_field 'password_confirmation', size => 30
            <br />
            %= submit_button 'Sign Up!'
        % end
    </body>
</html>
